@import com.mohiva.play.silhouette.api.actions.UserAwareRequest
@import silhouette.CookieEnv

@()(implicit request: UserAwareRequest[CookieEnv, AnyContent])

@template.template("カテゴリ管理") {
    <div class="columns">
        <div class="column is-one-quarter">
            <div id="app">
                <aside class="menu">
                    <p class="menu-label">
                        カテゴリ
                    </p>
                    <menu-list v-bind:data="data"></menu-list>
                </aside>
            </div>
        </div>
    </div>
    <script>
        Vue.component("menu-list", {
            props: ["data"],
            template: `
                <ul class="menu-list">
                    <menu-list-item v-for="category in data" v-bind:category="category"></menu-list-item>
                </ul>
            `
        })

        Vue.component("menu-list-item", {
            props: ["category"],
            template: `
                <li><a v-on:click="edit">{{ category.name }}</a></li>
            `,
            methods: {
                edit: function() {
                    location.href = `@routes.Category.index()/${this.category.id}/edit`
                }
            }
        })

        fetch("@routes.Category.list()", {
            credentials: 'include'
        }).then((res) => {return res.json()}).then((json) => {
            new Vue({
                el: "#app",
                data: {
                    data: json
                }
            })
        })
    </script>
}